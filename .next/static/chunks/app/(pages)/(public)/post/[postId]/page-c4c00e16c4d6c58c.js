(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4994],{20419:(e,a,t)=>{Promise.resolve().then(t.bind(t,33544))},33544:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>M});var i=t(95155),o=t(12115),l=t(64665),s=t(63551),n=t(30562),d=t(34883),r=t(42479),u=t(9561),m=t(69841),c=t(67882),p=t(71290),h=t(894),g=t(8707),y=t(36056),v=t(77159);function f(){let[e,a]=o.useState(null),t=!!e,l={"&:hover":{color:c.A["700"]}},s={"&:hover":{color:p.A["700"]}},n=()=>{a(null)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.A,{"aria-label":"settings",id:"basic-button","aria-controls":t?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":t?"true":void 0,onClick:e=>{a(e.currentTarget)},children:(0,i.jsx)(v.A,{})}),(0,i.jsxs)(g.A,{id:"basic-menu",anchorEl:e,open:t,onClose:n,MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,i.jsx)(y.A,{onClick:()=>{console.log("Edit Post clicked"),n()},sx:l,children:"Edit Post"}),(0,i.jsx)(y.A,{sx:s,onClick:()=>{console.log("Delete Post clicked"),n()},children:"Delete Post"})]})]})}var D=t(45933),x=t(38527),I=t(22293),_=t(71319),b=t(10979),k=t(2241),A=t(12111),j=t(90507),P=t(280),w=t(11441),S=t(67396),q=t(83391),N=t(56595),U=t(54388),C=t(18244),T=t(19347);let E=(0,_.Ay)("https://chat-along-external-server.onrender.com/");function O(e){let{comments:a,likes:t,id:l,creatorId:s}=e,[d,r]=(0,o.useState)(!1),[m,c]=(0,o.useState)(""),{isAuthenticated:p,userData:g}=(0,q.d4)(e=>e.User),y=(0,q.wA)(),[v]=(0,N.sc)(),[f]=(0,C.VY)(),[_]=(0,N.Ar)(),O=async()=>{if(p){if(await v(l),y((0,U.YH)({likesDetails:{_id:g._id||"",name:g.name||"",username:g.username||"",image:g.image||{image_url:"",public_id:""}},postId:l||""})),!t.find(e=>(null==e?void 0:e._id)===(null==g?void 0:g._id))){let e={senderId:g._id,senderName:g.name,senderImage:g.image,receiverId:s,action:"like",link:"/post/".concat(l)};E.off().emit("sendNotification",e),await f({senderName:g.name||"",image:g.image||{image_url:"",public_id:""},action:"like",link:"/post/".concat(l),receiverId:s})}}else y((0,T.$m)(!0))},L=async()=>{await _({postId:l,comment:m});let e={_id:g._id||"",name:g.name||"",username:g.username||"",image:g.image||{image_url:"",public_id:""}};y((0,U.g$)({commentDetails:{comment:m,userId:e},postId:l})),c("");let a={senderId:g._id,senderName:g.name,senderImage:g.image,receiverId:s,action:"comment",link:"/post/".concat(l)};E.off().emit("sendNotification",a),await f({senderName:g.name||"",image:g.image||{image_url:"",public_id:""},action:"comment",link:"/post/".concat(l),receiverId:s})};return(0,i.jsxs)(b.default,{direction:"column",spacing:2,width:"100%",children:[(0,i.jsxs)(b.default,{direction:"row",spacing:2,children:[(0,i.jsxs)(b.default,{direction:"column",spacing:0,justifyContent:"center",children:[(0,i.jsx)(h.A,{"aria-label":"Like",sx:{color:t.find(e=>(null==e?void 0:e._id)===(null==g?void 0:g._id))?"red":""},onClick:O,children:(0,i.jsx)(D.A,{})}),(0,i.jsxs)(u.A,{variant:"caption",color:"text.secondary",children:[t.length," Likes"]})]}),(0,i.jsxs)(b.default,{direction:"column",spacing:0,justifyContent:"center",children:[(0,i.jsx)(h.A,{onClick:()=>{r(!d)},"aria-label":"comment",sx:{color:d?"#06D001":""},children:(0,i.jsx)(x.A,{})}),(0,i.jsxs)(u.A,{variant:"caption",color:"text.secondary",children:[a.length," Comments"]})]})]}),d&&(0,i.jsxs)(b.default,{spacing:2,mt:2,width:"100%",children:[(0,i.jsx)(k.A,{}),(0,i.jsx)(b.default,{spacing:2,direction:"column-reverse",height:"200px",overflow:"auto",children:a.map((e,a)=>(0,i.jsxs)(b.default,{direction:"row",spacing:1,alignItems:"center",children:[(0,i.jsx)(n.A,{src:e.userId.image.image_url,alt:e.userId.username,style:{width:40,height:40}}),(0,i.jsxs)(b.default,{children:[(0,i.jsx)(S.default,{href:"/".concat(e.userId.username),style:{textDecoration:"none",color:"black"},children:(0,i.jsx)(u.A,{variant:"subtitle2",fontWeight:"bold",children:e.userId.username})}),(0,i.jsx)(u.A,{variant:"body2",children:e.comment})]})]},a))}),(0,i.jsx)(k.A,{}),(0,i.jsxs)(b.default,{direction:"row",spacing:2,alignItems:"center",children:[(0,i.jsx)(n.A,{src:"https://images.unsplash.com/photo-1527073620320-77635188c627?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Logged in user",style:{width:50,height:50}}),(0,i.jsxs)(A.A,{variant:"outlined",fullWidth:!0,color:"secondary",children:[(0,i.jsx)(j.A,{htmlFor:"outlined-adornment-add-comment",children:"Add a comment"}),(0,i.jsx)(P.A,{id:"outlined-adornment-add-comment",type:"text",value:m,onChange:e=>c(e.target.value),endAdornment:(0,i.jsx)(w.A,{position:"end",children:(0,i.jsx)(h.A,{"aria-label":"add-comment",onClick:L,edge:"end",children:(0,i.jsx)(I.A,{})})}),label:"Add a comment"})]})]})]})]})}var L=t(76046);function M(){var e,a,t,o,c;let{postId:p}=(0,L.useParams)(),{postsData:h}=(0,q.d4)(e=>e.Post),g=h.find(e=>e._id===p);return(0,i.jsxs)(l.A,{sx:{maxWidth:"100%",marginY:3},raised:!0,children:[(0,i.jsx)(s.A,{avatar:(0,i.jsx)(n.A,{src:null==g?void 0:null===(e=g.creator)||void 0===e?void 0:e.image.image_url}),action:(0,i.jsx)(f,{}),title:(0,i.jsx)(S.default,{href:"/".concat(null==g?void 0:null===(a=g.creator)||void 0===a?void 0:a.username),style:{textDecoration:"none",color:"black"},children:null==g?void 0:null===(t=g.creator)||void 0===t?void 0:t.name}),subheader:"1 Jan 2025"}),(0,i.jsx)(d.A,{component:"img",width:300,height:500,image:null==g?void 0:null===(o=g.post_image)||void 0===o?void 0:o.image_url}),(0,i.jsx)(r.A,{children:(0,i.jsx)(u.A,{variant:"body2",sx:{color:"black"},children:null==g?void 0:g.caption})}),(0,i.jsx)(m.A,{disableSpacing:!0,children:(0,i.jsx)(O,{likes:(null==g?void 0:g.likes)||[],comments:(null==g?void 0:g.comments)||[],id:(null==g?void 0:g._id)||"",creatorId:(null==g?void 0:null===(c=g.creator)||void 0===c?void 0:c._id)||""})})]})}},18244:(e,a,t)=>{"use strict";t.d(a,{DQ:()=>i.DQ,IM:()=>i.IM,Iq:()=>i.Iq,Ll:()=>i.Ll,R3:()=>i.R3,VY:()=>i.VY,_L:()=>i._L,gx:()=>i.gx,lJ:()=>i.lJ,og:()=>i.og,oq:()=>i.oq,qB:()=>i.qB,rU:()=>i.rU});var i=t(34120)},56595:(e,a,t)=>{"use strict";t.d(a,{Ar:()=>d,NB:()=>p,Qy:()=>y,UX:()=>c,W0:()=>s,d_:()=>l,sc:()=>n,t0:()=>h});var i=t(39295),o=t(30565);let l=(0,i.xP)({reducerPath:"postApi",baseQuery:(0,o.cw)({baseUrl:"http://localhost:3000"}),endpoints:e=>({login:e.mutation({query:e=>({url:"api/login",method:"POST",body:{email:e.email,password:e.password}})}),signup:e.mutation({query:e=>({url:"/api/signup",method:"POST",body:{email:e.email,password:e.password,name:e.name}})}),logout:e.mutation({query:()=>({url:"api/logout",method:"DELETE"})}),fetchPublicPostsData:e.query({query:()=>"api/get-all-posts"}),uploadImageToCloudinary:e.mutation({query:e=>({url:"https://chat-along-external-server.onrender.com/upload-to-cloudinary",method:"POST",body:e})}),deleteImageFromCloudinary:e.mutation({query:e=>({url:"https://chat-along-external-server.onrender.com/delete-from-cloudinary",method:"POST",body:{public_id:e}})}),createPost:e.mutation({query:e=>({url:"api/create-post",method:"POST",body:{post_image:e.post_image,caption:e.caption,date:e.date}})}),updateLink:e.mutation({query:e=>({url:"api/update-link",method:"PUT",body:{url:e.url,fullname:e.fullname,id:e.id,linkColor:e.linkColor}})}),deletePost:e.mutation({query:e=>({url:"api/delete-post",method:"DELETE",body:{postId:e}})}),likeUnlikePost:e.mutation({query:e=>({url:"api/like-unlike-post",method:"PUT",body:{postId:e}})}),commentPost:e.mutation({query:e=>({url:"api/comment-post",method:"POST",body:{postId:e.postId,comment:e.comment}})})})}),{useFetchPublicPostsDataQuery:s,useLikeUnlikePostMutation:n,useCommentPostMutation:d,useLoginMutation:r,useSignupMutation:u,useLogoutMutation:m,useUploadImageToCloudinaryMutation:c,useDeleteImageFromCloudinaryMutation:p,useCreatePostMutation:h,useUpdateLinkMutation:g,useDeletePostMutation:y}=l},34120:(e,a,t)=>{"use strict";t.d(a,{DQ:()=>n,IM:()=>u,Iq:()=>y,Ll:()=>s,R3:()=>p,VY:()=>D,_L:()=>d,dG:()=>l,gx:()=>x,lJ:()=>v,og:()=>h,oq:()=>r,qB:()=>f,rU:()=>m});var i=t(39295),o=t(30565);let l=(0,i.xP)({reducerPath:"usersApi",baseQuery:(0,o.cw)({baseUrl:"http://localhost:3000"}),endpoints:e=>({login:e.mutation({query:e=>({url:"api/login",method:"POST",body:{username:e.username,password:e.password}})}),checkEmailInDB:e.mutation({query:e=>({url:"api/check-email",method:"POST",body:{email:e}})}),checkUsernameInDB:e.mutation({query:e=>({url:"api/check-username",method:"POST",body:{firstName:e.firstName,phone:e.phone,username:e.username}})}),signup:e.mutation({query:e=>({url:"/api/signup",method:"POST",body:{email:e.email,password:e.password,name:e.name,image:e.image,username:e.username,phone:e.phone}})}),logout:e.mutation({query:()=>({url:"api/logout",method:"DELETE"})}),fetchUserData:e.query({query:()=>"api/get-user-profile"}),fetchAllUsersData:e.query({query:()=>"api/get-all-users"}),followUnfollowUser:e.mutation({query:e=>({url:"api/follow-unfollow-user",method:"PUT",body:{userId:e}})}),addStatus:e.mutation({query:e=>({url:"api/add-status",method:"POST",body:{statusContent:e.statusContent,colorCode:e.colorCode,colorName:e.colorName}})}),editProfile:e.mutation({query:e=>({url:"api/edit-user-profile",method:"PUT",body:{image:e.image,name:e.name,email:e.email,phone:e.phone}})}),deleteStatus:e.mutation({query:e=>({url:"api/delete-status",method:"DELETE",body:{statusId:e}})}),saveMessage:e.mutation({query:e=>({url:"api/save-message",method:"POST",body:{receiverId:e.receiverId,time:e.time,image:e.image,message:e.message}})}),clearMessages:e.mutation({query:e=>({url:"api/clear-messages",method:"POST",body:{receiverId:e}})}),saveNotification:e.mutation({query:e=>({url:"api/save-notification",method:"POST",body:{receiverId:e.receiverId,link:e.link,image:e.image,senderName:e.senderName,action:e.action}})}),clearNotifications:e.mutation({query:()=>({url:"api/clear-notifications",method:"PUT"})})})}),{useFetchUserDataQuery:s,useFetchAllUsersDataQuery:n,useLoginMutation:d,useCheckEmailInDBMutation:r,useCheckUsernameInDBMutation:u,useSignupMutation:m,useLogoutMutation:c,useFollowUnfollowUserMutation:p,useAddStatusMutation:h,useEditProfileMutation:g,useDeleteStatusMutation:y,useSaveMessageMutation:v,useClearMessagesMutation:f,useSaveNotificationMutation:D,useClearNotificationsMutation:x}=l},54388:(e,a,t)=>{"use strict";t.d(a,{Aj:()=>l,Fn:()=>o,VA:()=>s,Vr:()=>i,YH:()=>n,g$:()=>d});let i=(0,t(72212).Z0)({name:"Post",initialState:{postsData:[],loading:!1},reducers:{storePublicPostDataInState:(e,a)=>{e.postsData=a.payload},deletePostFromState:(e,a)=>{e.postsData=e.postsData.filter(e=>e._id!==a.payload)},likeUnlikePostInState:(e,a)=>{var t,i,o,l,s;let n=e.postsData.find(e=>e._id===a.payload.postId);if(null==n?void 0:null===(t=n.likes)||void 0===t?void 0:t.find(e=>e._id===a.payload.likesDetails._id)){let t=null==n?void 0:null===(o=n.likes)||void 0===o?void 0:o.findIndex(e=>e._id===a.payload.likesDetails._id);null===(s=e.postsData.find(e=>e._id===a.payload.postId))||void 0===s||null===(l=s.likes)||void 0===l||l.splice(t||0,1)}else null==n||null===(i=n.likes)||void 0===i||i.push({_id:a.payload.likesDetails._id,image:a.payload.likesDetails.image,name:a.payload.likesDetails.name,username:a.payload.likesDetails.username})},commentPostInState:(e,a)=>{var t;let i=e.postsData.find(e=>e._id===a.payload.postId);null==i||null===(t=i.comments)||void 0===t||t.push({comment:a.payload.commentDetails.comment,userId:{name:a.payload.commentDetails.userId.name,_id:a.payload.commentDetails.userId._id,username:a.payload.commentDetails.userId.username,image:a.payload.commentDetails.userId.image}})},changeLoadingState:(e,a)=>{e.loading=a.payload}}}),{storePublicPostDataInState:o,changeLoadingState:l,deletePostFromState:s,likeUnlikePostInState:n,commentPostInState:d}=i.actions},19347:(e,a,t)=>{"use strict";t.d(a,{$m:()=>d,Aj:()=>v,BJ:()=>u,Jx:()=>s,N1:()=>c,Sl:()=>p,Xn:()=>l,aP:()=>h,cE:()=>r,mF:()=>m,oN:()=>i,rM:()=>n,yQ:()=>g,zY:()=>o});let i=(0,t(72212).Z0)({name:"Users",initialState:{userData:{},allUsersData:[],loading:!0,isAuthenticated:!1,isDialogOpened:!1},reducers:{storeUserDataInState:(e,a)=>{e.userData=a.payload},storeAllUsersDataInState:(e,a)=>{e.allUsersData=a.payload},followUnfollowUserInState:(e,a)=>{var t,i,o,l,s,n,d;let r=null===(t=e.userData.following)||void 0===t?void 0:t.find(e=>e._id===a.payload._id),u=e.allUsersData.find(e=>e._id===a.payload._id);if(r){let t=null===(i=e.userData.following)||void 0===i?void 0:i.findIndex(e=>e._id===a.payload._id);null===(o=e.userData.following)||void 0===o||o.splice(Number(t),1);let n=null==u?void 0:null===(l=u.followers)||void 0===l?void 0:l.find(a=>a._id===e.userData._id);null==u||null===(s=u.followers)||void 0===s||s.splice(Number(n),1)}else null===(n=e.userData.following)||void 0===n||n.push({_id:a.payload._id,name:a.payload.name,image:a.payload.image,username:a.payload.username}),null==u||null===(d=u.followers)||void 0===d||d.push({_id:e.userData._id||"",name:e.userData.name||"",image:e.userData.image||{image_url:"",public_id:""},username:e.userData.username||""})},handleAuthentication:(e,a)=>{e.isAuthenticated=a.payload},handleDialog:(e,a)=>{e.isDialogOpened=a.payload},changeLoadingState:(e,a)=>{e.loading=a.payload},sendMessageInState:(e,a)=>{var t,i;e.userData.chats||(e.userData.chats={}),(null===(t=e.userData.chats)||void 0===t?void 0:t[a.payload.receiverId])||(e.userData.chats[a.payload.receiverId]=[]),null===(i=e.userData.chats)||void 0===i||i[a.payload.receiverId].push({message:a.payload.message,image:a.payload.image,time:a.payload.time,name:"sender",seen:!1})},receiveMessageInState:(e,a)=>{var t,i;e.userData.chats||(e.userData.chats={}),(null===(t=e.userData.chats)||void 0===t?void 0:t[a.payload.senderId])||(e.userData.chats[a.payload.senderId]=[]),null===(i=e.userData.chats)||void 0===i||i[a.payload.senderId].push({message:a.payload.message,image:a.payload.image,time:a.payload.time,name:"receiver",seen:!1})},clearMessagesInState:(e,a)=>{var t;e.userData.chats||(e.userData.chats={}),(null===(t=e.userData.chats)||void 0===t?void 0:t[a.payload])||(e.userData.chats[a.payload]=[]),e.userData.chats[a.payload]=[]},receiveNotificationInState:(e,a)=>{e.userData.notifications||(e.userData.notifications=[]),e.userData.notifications.push({name:a.payload.name,image:a.payload.image,action:a.payload.action,link:a.payload.link})},clearNotificationsInState:e=>{e.userData.notifications=[]},seenMessageInState:(e,a)=>{var t;let i=a.payload;(null===(t=e.userData.chats)||void 0===t?void 0:t[i])&&(e.userData.chats[i][e.userData.chats[i].length-1].seen=!0)},addStatusInState:(e,a)=>{if(e.userData.status){var t,i;null==e||null===(i=e.userData)||void 0===i||i.status.push({statusContent:a.payload.statusContent,colorCode:a.payload.colorCode,colorName:a.payload.colorName,_id:String((null===(t=e.userData.status)||void 0===t?void 0:t.length)+1)})}},deleteStatusInState:(e,a)=>{if(e.userData.status){let t=e.userData.status.findIndex(e=>e._id===a.payload);e.userData.status.splice(Number(t),1)}}}}),{storeUserDataInState:o,storeAllUsersDataInState:l,followUnfollowUserInState:s,handleAuthentication:n,handleDialog:d,sendMessageInState:r,receiveMessageInState:u,clearMessagesInState:m,receiveNotificationInState:c,clearNotificationsInState:p,addStatusInState:h,deleteStatusInState:g,seenMessageInState:y,changeLoadingState:v}=i.actions}},e=>{var a=a=>e(e.s=a);e.O(0,[7150,7089,7396,9295,1146,3894,280,3801,2976,5596,1967,279,8441,1517,7358],()=>a(20419)),_N_E=e.O()}]);